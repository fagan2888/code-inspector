<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>k-fold Cross-Validation applied to an autoregressive model — CVar • forecast</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">forecast</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://cran.r-project.org/web/packages/forecast/vignettes/JSS2008.pdf">JSS paper</a>
</li>
<li>
  <a href="../news/index.html">Change Log</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/robjhyndman/forecast">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>k-fold Cross-Validation applied to an autoregressive model</h1>
    </div>

    
    <p><code>CVar</code> computes the errors obtained by applying an autoregressive
modelling function to subsets of the time series <code>y</code> using k-fold
cross-validation as described in Bergmeir, Hyndman and Koo (2015). It also
applies a Ljung-Box test to the residuals. If this test is significant
(see returned pvalue), there is serial correlation in the residuals and the
model can be considered to be underfitting the data. In this case, the
cross-validated errors can underestimate the generalization error and should
not be used.</p>
    

    <pre class="usage"><span class='fu'>CVar</span>(<span class='no'>y</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='no'>nnetar</span>, <span class='kw'>cvtrace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>blocked</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>LBlags</span> <span class='kw'>=</span> <span class='fl'>24</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>Univariate time series</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>Number of folds to use for cross-validation.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>Function to fit an autoregressive model. Currently, it only works
with the <code><a href='nnetar.html'>nnetar</a></code> function.</p></td>
    </tr>
    <tr>
      <th>cvtrace</th>
      <td><p>Provide progress information.</p></td>
    </tr>
    <tr>
      <th>blocked</th>
      <td><p>choose folds randomly or as blocks?</p></td>
    </tr>
    <tr>
      <th>LBlags</th>
      <td><p>lags for the Ljung-Box test, defaults to 24, for yearly series can be set to 20</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments are passed to <code>FUN</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing information about the model and accuracy for each
fold, plus other summary information computed across folds.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bergmeir, C., Hyndman, R.J., Koo, B. (2015) A note on the
validity of cross-validation for evaluating time series prediction. Monash
working paper 10/15.
<a href='https://robjhyndman.com/publications/cv-time-series/'>https://robjhyndman.com/publications/cv-time-series/</a>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><a href='CV.html'>CV</a>, <a href='tsCV.html'>tsCV</a>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>modelcv</span> <span class='kw'>&lt;-</span> <span class='fu'>CVar</span>(<span class='no'>lynx</span>, <span class='kw'>k</span><span class='kw'>=</span><span class='fl'>5</span>, <span class='kw'>lambda</span><span class='kw'>=</span><span class='fl'>0.15</span>)
<span class='fu'>print</span>(<span class='no'>modelcv</span>)</div><div class='output co'>#&gt; Series: lynx 
#&gt; Call:   CVar(y = lynx, k = 5, lambda = 0.15)
#&gt; 
#&gt; 5-fold cross-validation
#&gt;                    Mean          SD
#&gt; ME        -117.82171245 207.4297895
#&gt; RMSE       865.97203798 245.8837532
#&gt; MAE        578.72048791 190.6054503
#&gt; MPE        -27.84715313  35.0711508
#&gt; MAPE        60.02540438  27.5811199
#&gt; ACF1        -0.01593769   0.2704894
#&gt; Theil's U    0.90977105   0.1692362
#&gt; 
#&gt; p-value of Ljung-Box test of residuals is  0.395016 
#&gt; if this value is significant (&lt;0.05),
#&gt; the result of the cross-validation should not be used
#&gt; as the model is underfitting the data.</div><div class='input'><span class='fu'>print</span>(<span class='no'>modelcv</span>$<span class='no'>fold1</span>)</div><div class='output co'>#&gt; $model
#&gt; Series: y 
#&gt; Model:  NNAR(11,6) 
#&gt; Call:   FUN(y = y, lambda = 0.15, subset = trainset)
#&gt; 
#&gt; Average of 20 networks, each of which is
#&gt; a 11-6-1 network with 79 weights
#&gt; options were - linear output units 
#&gt; 
#&gt; sigma^2 estimated as 0.0949
#&gt; 
#&gt; $accuracy
#&gt;                 ME     RMSE      MAE       MPE     MAPE      ACF1 Theil's U
#&gt; Test set -352.3341 1070.599 760.3141 -89.87951 109.2968 0.3525681 0.9065455
#&gt; 
#&gt; $testfit
#&gt; Time Series:
#&gt; Start = 1821 
#&gt; End = 1934 
#&gt; Frequency = 1 
#&gt;   [1]         NA         NA         NA         NA         NA         NA
#&gt;   [7]         NA         NA         NA         NA         NA  101.75376
#&gt;  [13]   75.63250  279.18481  401.45385 2260.07758 2776.36220 3301.93016
#&gt;  [19] 2091.84926  422.70874  152.82627   49.92780   66.70592  212.78961
#&gt;  [25]  539.00780 1208.53829 2186.79354 2651.64690 1627.16474   97.54252
#&gt;  [31]  331.27797  262.02623  380.68528  708.80436 1615.80876 2810.97789
#&gt;  [37] 2986.69049 1465.02411  670.90534   48.18993  264.94739  244.84388
#&gt;  [43]  537.02595 1568.35232 2448.78899 6631.84452 5743.22310  696.78049
#&gt;  [49]   91.22638  406.82358  367.96936  777.19384 1595.11859 1703.15883
#&gt;  [55] 2280.19615 1493.19194  746.90906  309.70980   49.57798  235.10176
#&gt;  [61]  450.93504  772.98062 2005.29294 4215.68561 4349.51306 2599.72257
#&gt;  [67]  389.46891   71.27874   56.42066   50.12881   62.15109  187.23463
#&gt;  [73]  384.90933 1281.58867 3636.50640 3465.97163  602.56479  108.39331
#&gt;  [79]  151.22400  352.06409  776.84117 1330.62400 1303.26188 6720.89559
#&gt;  [85] 3717.38720 1927.20156 1354.89526  667.76736  369.26665  784.32177
#&gt;  [91] 1398.79763 2679.84181 3669.54660 3033.69807 2957.75479 3378.76086
#&gt;  [97]  692.67101   80.35001   82.21984  115.48522  224.56574  404.59910
#&gt; [103] 1171.73316 2505.62325 2304.73469 2913.80476 1444.11455  516.79534
#&gt; [109]  361.01307  488.04164 1002.86808 1610.44373 2586.07776 3344.61237
#&gt; 
#&gt; $testset
#&gt;  [1]   4   9  10  13  26  29  30  38  40  45  47  49  59  64  69  83  85  86  87
#&gt; [20]  88 105 109 110
#&gt; </div><div class='input'>
<span class='fu'>plot</span>(<span class='no'>lynx</span>)</div><div class='input'><span class='fu'>lines</span>(<span class='no'>modelcv</span>$<span class='no'>testfit</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"green"</span>)</div><div class='input'><span class='fu'>lines</span>(<span class='no'>modelcv</span>$<span class='no'>residuals</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"red"</span>)</div><div class='img'><img src='CVar-1.png' alt='' width='700' height='432.632880098887' /></div><div class='input'><span class='fu'><a href='Acf.html'>Acf</a></span>(<span class='no'>modelcv</span>$<span class='no'>residuals</span>)</div><div class='img'><img src='CVar-2.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Gabriel Caceres and Rob J Hyndman

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://robjhyndman.com'>Rob Hyndman</a>, <a href='https://github.com/cbergmeir'>Christoph Bergmeir</a>, <a href='https://github.com/gabrielcaceres'>Gabriel Caceres</a>, <a href='https://github.com/mitchelloharawild'>Mitchell O'Hara-Wild</a>, <a href='https://github.com/slavarazbash'>Slava Razbash</a>, <a href='http://earo.me'>Earo Wang</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
